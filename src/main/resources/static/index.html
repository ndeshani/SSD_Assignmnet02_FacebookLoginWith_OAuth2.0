<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<title>Facebook Login Demo withOAuth</title>
		<meta name="description" content="" />
		<meta name="viewport" content="width=device-width" />
		<base href="/" />
		
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
  		
	</head>
	
	<body>
		<br/>
		<br/>
		<br/>
		<br/>
			<div align="center">
				<div class="card text-white bg-dark mb-3" style="max-width: 40rem;" style="max-height: 40rem;" >
					<div class="card-body">
						<div class="card-header"><h2>Tickets.lk</h2></div>
		    			
		    				<div class="unauthenticated">
		    					<h4>Book a ticket of your favourite show today..!</h4>
		    					<br/>
		    					<div>If you need to proceed, you have to log in to your Facebook account.</div>
		    					<br/>
		    					
								<div>
			      					<a class="btn btn-success" href="/login">Login Now</a>
			      					<br/>
			    				</div>
		    				</div>
		    				
		    				<div class="authenticated" style="display: none">
				    			<h4>Thank You for joining with us..!</h4>
				    			<br/>
				      			You are Logged in as: <span id="user"></span>
				      			<br/>
				      			<br/>
		      					<div>
				        			<button onClick="logout()" class="btn btn-success">Logout</button>
				        			<br/>
				        			<br/>
		      					</div>
		      				</div>	
		    		</div>
				</div>
				
		    	<script>
					  if (window.location.hash == '#_=_'){
					      history.replaceState 
					          ? history.replaceState(null, null, window.location.href.split('#')[0])
					          : window.location.hash = '';
					  }
					  
					  $.get("/user", function(data) {
						    $("#user").html(data.userAuthentication.details.name);
						    $(".unauthenticated").hide();
						    $(".authenticated").show();
						  });
					  
					  var logout = function() {
						    $.post("/logout", function() {
						      $("#user").html('');
						      $(".unauthenticated").show();
						      $(".authenticated").hide();
						    });
						    return true;
						  }
					  
			   </script>			  
		   </div> 		 	
	</body>
</html>